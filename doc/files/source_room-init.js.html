<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>SkylinkJS 0.6.16</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- font and icon -->
    <link rel="shortcut icon" type="image/ico" href="../assets/favicon.ico">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700|Source+Sans+Pro" type="text/css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700|Source+Code+Pro" type="text/css">
    <!-- styling -->
    <link rel="stylesheet" href="../assets/vendor/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/vendor/css/bootstrap-theme.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="../assets/css/style.css">
    <!-- scripts -->
    <script src="../assets/vendor/js/jquery.min.js"></script>
    <script src="../assets/vendor/js/bootstrap.min.js"></script>
    <script src="../assets/js/script.js"></script>
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body>

<div id="doc">
  <nav id="hd" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a href="" class="navbar-brand">
          <img src="../assets/img/logo.svg" />JS<small>Version: 0.6.16</small>
        </a>
      </div>
      <div id="navbar" class="navbar-collapse collapse">
        <ul id="api-list" class="nav navbar-nav navbar-right">
  <li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started Examples <span class="caret"></span></a>
    <ul class="dropdown-menu" role="menu">
      <li><a href="https://temasys.com.sg/getting-started-with-webrtc-and-skylinkjs/">Setting up a Video Call</a></li>
      <li><a href="https://temasys.com.sg/screensharing-with-skylinkjs/">Setting up Screensharing</a></li>
      <li><a href="https://temasys.com.sg/building-a-simple-peer-to-peer-webrtc-chat/">Setting up a Chatroom</a></li>
    </ul>
  </li>
  
    <li><a href="../classes/Skylink.html">Documentation</a></li>
  
  <!--<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Classes <span class="caret"></span></a>
    <ul class="dropdown-menu" role="menu">
      
        <li><a href="../classes/Skylink.html">Skylink</a></li>
      
    </ul>
  </li>-->
  <li><a class="btn btn-info btn-navbar" href="http://developer.temasys.com.sg/">Developer Console</a></li>
  <li><a class="btn btn-info btn-navbar" href="http://support.temasys.com.sg/">Support</a></li>
  <!--<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Modules <span class="caret"></span></a>
    <ul class="dropdown-menu" role="menu">
      <li><a href="#api-modules">View all Modules</a></li>
      
    </ul>
  </li>-->
</ul>
<!--<form id="api-tabview" class="navbar-form navbar-right" role="form">
  <div id="api-tabview-filter" class="form-group">
    <input type="search" id="api-filter" placeholder="Type to filter APIs">
  </div>
</form>-->
      </div><!--/.navbar-collapse -->
    </div>
  </nav>
  <div id="bd" class="yui3-g">

      <div class="yui3-u-1-4">

      </div>
      <div class="yui3-u-3-4">
          
          <div class="apidocs">
              <div id="docs-main">
                  <div class="content content-main">
                      <h1 class="file-heading">File: source/room-init.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Contains the current version of Skylink Web SDK.
 * @attribute VERSION
 * @type String
 * @readOnly
 * @for Skylink
 * @since 0.1.0
 */
Skylink.prototype.VERSION = &#x27;@@version&#x27;;

/**
 * The list of &lt;a href=&quot;#method_init&quot;&gt;&lt;code&gt;init()&lt;/code&gt; method&lt;/a&gt; ready states.
 * @attribute READY_STATE_CHANGE
 * @param {Number} INIT      &lt;small&gt;Value &lt;code&gt;0&lt;/code&gt;&lt;/small&gt;
 *   The value of the state when &lt;code&gt;init()&lt;/code&gt; has just started.
 * @param {Number} LOADING   &lt;small&gt;Value &lt;code&gt;1&lt;/code&gt;&lt;/small&gt;
 *   The value of the state when &lt;code&gt;init()&lt;/code&gt; is authenticating App Key provided
 *   (and with credentials if provided as well) with the Auth server.
 * @param {Number} COMPLETED &lt;small&gt;Value &lt;code&gt;2&lt;/code&gt;&lt;/small&gt;
 *   The value of the state when &lt;code&gt;init()&lt;/code&gt; has successfully authenticated with the Auth server.
 *   Room session token is generated for joining the &lt;code&gt;defaultRoom&lt;/code&gt; provided in &lt;code&gt;init()&lt;/code&gt;.
 *   &lt;small&gt;Room session token has to be generated each time User switches to a different Room
 *   in &lt;a href=&quot;#method_joinRoom&quot;&gt;&lt;code&gt;joinRoom()&lt;/code&gt; method&lt;/a&gt;.&lt;/small&gt;
 * @param {Number} ERROR     &lt;small&gt;Value &lt;code&gt;-1&lt;/code&gt;&lt;/small&gt;
 *   The value of the state when &lt;code&gt;init()&lt;/code&gt; has failed authenticating with the Auth server.
 *   [Rel: Skylink.READY_STATE_CHANGE_ERROR]
 * @type JSON
 * @readOnly
 * @for Skylink
 * @since 0.1.0
 */
Skylink.prototype.READY_STATE_CHANGE = {
  INIT: 0,
  LOADING: 1,
  COMPLETED: 2,
  ERROR: -1
};

/**
 * The list of &lt;a href=&quot;#method_init&quot;&gt;&lt;code&gt;init()&lt;/code&gt; method&lt;/a&gt; ready state failure codes.
 * @attribute READY_STATE_CHANGE_ERROR
 * @param {Number} API_INVALID                 &lt;small&gt;Value &lt;code&gt;4001&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when provided App Key in &lt;code&gt;init()&lt;/code&gt; does not exists.
 *   &lt;small&gt;To resolve this, check that the provided App Key exists in
 *   &lt;a href=&quot;https://console.temasys.io&quot;&gt;the Temasys Console&lt;/a&gt;.&lt;/small&gt;
 * @param {Number} API_DOMAIN_NOT_MATCH        &lt;small&gt;Value &lt;code&gt;4002&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when &lt;code&gt;&quot;domainName&quot;&lt;/code&gt; property in the App Key does not
 *   match the accessing server IP address.
 *   &lt;small&gt;To resolve this, contact our &lt;a href=&quot;http://support.temasys.com.sg&quot;&gt;support portal&lt;/a&gt;.&lt;/small&gt;
 * @param {Number} API_CORS_DOMAIN_NOT_MATCH   &lt;small&gt;Value &lt;code&gt;4003&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when &lt;code&gt;&quot;corsurl&quot;&lt;/code&gt; property in the App Key does not match accessing CORS.
 *   &lt;small&gt;To resolve this, configure the App Key CORS in
 *   &lt;a href=&quot;https://console.temasys.io&quot;&gt;the Temasys Console&lt;/a&gt;.&lt;/small&gt;
 * @param {Number} API_CREDENTIALS_INVALID     &lt;small&gt;Value &lt;code&gt;4004&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when there is no [CORS](https://en.wikipedia.org/wiki/Cross-origin_resource_sharing)
 *   present in the HTTP headers during the request to the Auth server present nor
 *   &lt;code&gt;options.credentials.credentials&lt;/code&gt; configuration provided in the &lt;code&gt;init()&lt;/code&gt;.
 *   &lt;small&gt;To resolve this, ensure that CORS are present in the HTTP headers during the request to the Auth server.&lt;/small&gt;
 * @param {Number} API_CREDENTIALS_NOT_MATCH   &lt;small&gt;Value &lt;code&gt;4005&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when the &lt;code&gt;options.credentials.credentials&lt;/code&gt; configuration provided in the
 *   &lt;code&gt;init()&lt;/code&gt; does not match up with the &lt;code&gt;options.credentials.startDateTime&lt;/code&gt;,
 *   &lt;code&gt;options.credentials.duration&lt;/code&gt; or that the &lt;code&gt;&quot;secret&quot;&lt;/code&gt; used to generate
 *   &lt;code&gt;options.credentials.credentials&lt;/code&gt; does not match the App Key&#x27;s &lt;code&gt;&quot;secret&lt;/code&gt; property provided.
 *   &lt;small&gt;To resolve this, check that the &lt;code&gt;options.credentials.credentials&lt;/code&gt; is generated correctly and
 *   that the &lt;code&gt;&quot;secret&quot;&lt;/code&gt; used to generate it is from the App Key provided in the &lt;code&gt;init()&lt;/code&gt;.&lt;/small&gt;
 * @param {Number} API_INVALID_PARENT_KEY      &lt;small&gt;Value &lt;code&gt;4006&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when the App Key provided does not belong to any existing App.
 *   &lt;small&gt;To resolve this, check that the provided App Key exists in
 *   &lt;a href=&quot;https://console.temasys.io&quot;&gt;the Developer Console&lt;/a&gt;.&lt;/small&gt;
 * @param {Number} API_NO_MEETING_RECORD_FOUND &lt;small&gt;Value &lt;code&gt;4010&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when provided &lt;code&gt;options.credentials&lt;/code&gt;
 *   does not match any scheduled meetings available for the &quot;Persistent Room&quot; enabled App Key provided.
 *   &lt;small&gt;See the &lt;a href=&quot;http://support.temasys.com.sg/support/solutions/articles/
 * 12000002811-using-the-persistent-room-feature-to-configure-meetings&quot;&gt;Persistent Room article&lt;/a&gt; to learn more.&lt;/small&gt;
 * @param {Number} API_OVER_SEAT_LIMIT         &lt;small&gt;Value &lt;code&gt;4020&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when App Key has reached its current concurrent users limit.
 *   &lt;small&gt;To resolve this, use another App Key. To create App Keys dynamically, see the
 *   &lt;a href=&quot;https://temasys.atlassian.net/wiki/display/TPD/SkylinkAPI+-+Application+Resources&quot;&gt;Application REST API
 *   docs&lt;/a&gt; for more information.&lt;/small&gt;
 * @param {Number} API_RETRIEVAL_FAILED        &lt;small&gt;Value &lt;code&gt;4021&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when App Key retrieval of authentication token fails.
 *   &lt;small&gt;If this happens frequently, contact our &lt;a href=&quot;http://support.temasys.com.sg&quot;&gt;support portal&lt;/a&gt;.&lt;/small&gt;
 * @param {Number} API_WRONG_ACCESS_DOMAIN     &lt;small&gt;Value &lt;code&gt;5005&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when App Key makes request to the incorrect Auth server.
 *   &lt;small&gt;To resolve this, ensure that the &lt;code&gt;roomServer&lt;/code&gt; is not configured. If this persists even without
 *   &lt;code&gt;roomServer&lt;/code&gt; configuration, contact our &lt;a href=&quot;http://support.temasys.com.sg&quot;&gt;support portal&lt;/a&gt;.&lt;/small&gt;
 * @param {Number} XML_HTTP_REQUEST_ERROR      &lt;small&gt;Value &lt;code&gt;-1&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when requesting to Auth server has timed out.
 * @param {Number} NO_SOCKET_IO                &lt;small&gt;Value &lt;code&gt;1&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when dependency &lt;a href=&quot;http://socket.io/download/&quot;&gt;Socket.IO client&lt;/a&gt; is not loaded.
 *   &lt;small&gt;To resolve this, ensure that the Socket.IO client dependency is loaded before the Skylink SDK.
 *   You may use the provided Socket.IO client &lt;a href=&quot;http://socket.io/download/&quot;&gt;CDN here&lt;/a&gt;.&lt;/small&gt;
 * @param {Number} NO_XMLHTTPREQUEST_SUPPORT   &lt;small&gt;Value &lt;code&gt;2&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest&quot;&gt;
 *   XMLHttpRequest API&lt;/a&gt; required to make request to Auth server is not supported.
 *   &lt;small&gt;To resolve this, display in the Web UI to ask clients to switch to the list of supported browser
 *   as &lt;a href=&quot;https://github.com/Temasys/SkylinkJS/tree/0.6.14#supported-browsers&quot;&gt;listed in here&lt;/a&gt;.&lt;/small&gt;
 * @param {Number} NO_WEBRTC_SUPPORT           &lt;small&gt;Value &lt;code&gt;3&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/&quot;&gt;
 *   RTCPeerConnection API&lt;/a&gt; required for Peer connections is not supported.
 *   &lt;small&gt;To resolve this, display in the Web UI to ask clients to switch to the list of supported browser
 *   as &lt;a href=&quot;https://github.com/Temasys/SkylinkJS/tree/0.6.14#supported-browsers&quot;&gt;listed in here&lt;/a&gt;.
 *   For &lt;a href=&quot;http://confluence.temasys.com.sg/display/TWPP&quot;&gt;plugin supported browsers&lt;/a&gt;, if the clients
 *   does not have the plugin installed, there will be an installation toolbar that will prompt for installation
 *   to support the RTCPeerConnection API.&lt;/small&gt;
 * @param {Number} NO_PATH                     &lt;small&gt;Value &lt;code&gt;4&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when provided &lt;code&gt;init()&lt;/code&gt; configuration has errors.
 * @param {Number} ADAPTER_NO_LOADED           &lt;small&gt;Value &lt;code&gt;7&lt;/code&gt;&lt;/small&gt;
 *   The value of the failure code when dependency &lt;a href=&quot;https://github.com/Temasys/AdapterJS/&quot;&gt;AdapterJS&lt;/a&gt;
 *   is not loaded.
 *   &lt;small&gt;To resolve this, ensure that the AdapterJS dependency is loaded before the Skylink dependency.
 *   You may use the provided AdapterJS &lt;a href=&quot;https://github.com/Temasys/AdapterJS/&quot;&gt;CDN here&lt;/a&gt;.&lt;/small&gt;
 * @type JSON
 * @readOnly
 * @for Skylink
 * @since 0.4.0
 */
Skylink.prototype.READY_STATE_CHANGE_ERROR = {
  API_INVALID: 4001,
  API_DOMAIN_NOT_MATCH: 4002,
  API_CORS_DOMAIN_NOT_MATCH: 4003,
  API_CREDENTIALS_INVALID: 4004,
  API_CREDENTIALS_NOT_MATCH: 4005,
  API_INVALID_PARENT_KEY: 4006,
  API_NO_MEETING_RECORD_FOUND: 4010,
  API_OVER_SEAT_LIMIT: 4020,
  API_RETRIEVAL_FAILED: 4021,
  API_WRONG_ACCESS_DOMAIN: 5005,
  XML_HTTP_REQUEST_ERROR: -1,
  NO_SOCKET_IO: 1,
  NO_XMLHTTPREQUEST_SUPPORT: 2,
  NO_WEBRTC_SUPPORT: 3,
  NO_PATH: 4,
  ADAPTER_NO_LOADED: 7
};

/**
 * Spoofs the REGIONAL_SERVER to prevent errors on deployed apps except the fact this no longer works.
 * Automatic regional selection has already been implemented hence REGIONAL_SERVER is no longer useful.
 * @attribute REGIONAL_SERVER
 * @type JSON
 * @readOnly
 * @private
 * @for Skylink
 * @since 0.6.16
 */
Skylink.prototype.REGIONAL_SERVER = {
  APAC1: &#x27;&#x27;,
  US1: &#x27;&#x27;
};

/**
 * Function that generates an &lt;a href=&quot;https://en.wikipedia.org/wiki/Universally_unique_identifier&quot;&gt;UUID&lt;/a&gt; (Unique ID).
 * @method generateUUID
 * @return {String} Returns a generated UUID (Unique ID).
 * @for Skylink
 * @since 0.5.9
 */
/* jshint ignore:start */
Skylink.prototype.generateUUID = function() {
  var d = new Date().getTime();
  var uuid = &#x27;xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx&#x27;.replace(/[xy]/g, function(c) {
    var r = (d + Math.random() * 16) % 16 | 0;
    d = Math.floor(d / 16);
    return (c === &#x27;x&#x27; ? r : (r &amp;&amp; 0x7 | 0x8)).toString(16);
  });
  return uuid;
};
/* jshint ignore:end */

/**
 * Function that authenticates and initialises App Key used for Room connections.
 * @method init
 * @param {JSON|String} options The configuration options.
 * - When provided as a string, it&#x27;s configured as &lt;code&gt;options.appKey&lt;/code&gt;.
 * @param {String} options.appKey The App Key.
 *   &lt;small&gt;By default, &lt;code&gt;init()&lt;/code&gt; uses [HTTP CORS](https://en.wikipedia.org/wiki/Cross-origin_resource_sharing)
 *   authentication. For credentials based authentication, see the &lt;code&gt;options.credentials&lt;/code&gt; configuration
 *   below. You can know more about the &lt;a href=&quot;http://support.temasys.com.sg/support/solutions/articles/
 * 12000002712-authenticating-your-application-key-to-start-a-connection&quot;&gt;in the authentication methods article here&lt;/a&gt;
 *   for more details on the various authentication methods.&lt;/small&gt;
 *   &lt;small&gt;If you are using the Persistent Room feature for scheduled meetings, you will require to
 *   use the credential based authentication. See the &lt;a href=&quot;http://support.temasys.com.sg/support
 * /solutions/articles/12000002811-using-the-persistent-room-feature-to-configure-meetings&quot;&gt;Persistent Room article here
 *   &lt;/a&gt; for more information.&lt;/small&gt;
 * @param {String} [options.defaultRoom] The default Room to connect to when no &lt;code&gt;room&lt;/code&gt; parameter
 *    is provided in  &lt;a href=&quot;#method_joinRoom&quot;&gt;&lt;code&gt;joinRoom()&lt;/code&gt; method&lt;/a&gt;.
 * - When not provided or is provided as an empty string, its value is &lt;code&gt;options.appKey&lt;/code&gt;.
 *   &lt;small&gt;Note that switching Rooms is not available when using &lt;code&gt;options.credentials&lt;/code&gt; based authentication.
 *   The Room that User will be connected to is the &lt;code&gt;defaultRoom&lt;/code&gt; provided.&lt;/small&gt;
 * @param {String} [options.roomServer] The Auth server.
 * &lt;small&gt;Note that this is a debugging feature and is only used when instructed for debugging purposes.&lt;/small&gt;
 * @param {Boolean} [options.enableIceTrickle=true] The flag if Peer connections should
 *   trickle ICE for faster connectivity.
 * @param {Boolean} [options.enableDataChannel=true] The flag if Datachannel connections should be enabled.
 *   &lt;small&gt;This is required to be enabled for &lt;a href=&quot;#method_sendBlobData&quot;&gt;&lt;code&gt;sendBlobData()&lt;/code&gt; method&lt;/a&gt;,
 *   &lt;a href=&quot;#method_sendURLData&quot;&gt;&lt;code&gt;sendURLData()&lt;/code&gt; method&lt;/a&gt; and
 *   &lt;a href=&quot;#method_sendP2PMessage&quot;&gt;&lt;code&gt;sendP2PMessage()&lt;/code&gt; method&lt;/a&gt;.&lt;/small&gt;
 * @param {Boolean} [options.enableTURNServer=true] The flag if TURN ICE servers should
 *   be used when constructing Peer connections to allow TURN connections when required and enabled for the App Key.
 * @param {Boolean} [options.enableSTUNServer=true] The flag if STUN ICE servers should
 *   be used when constructing Peer connections to allow TURN connections when required.
 * @param {Boolean} [options.forceTURN=false] The flag if Peer connections should enforce
 *   connections over the TURN server.
 *   &lt;small&gt;This overrides &lt;code&gt;options.enableTURNServer&lt;/code&gt; value to &lt;code&gt;true&lt;/code&gt; and
 *   &lt;code&gt;options.enableSTUNServer&lt;/code&gt; value to &lt;code&gt;false&lt;/code&gt;, &lt;code&gt;options.filterCandidatesType.host&lt;/code&gt;
 *   value to &lt;code&gt;true&lt;/code&gt;, &lt;code&gt;options.filterCandidatesType.srflx&lt;/code&gt; value to &lt;code&gt;true&lt;/code&gt; and
 *   &lt;code&gt;options.filterCandidatesType.relay&lt;/code&gt; value to &lt;code&gt;false&lt;/code&gt;.&lt;/small&gt;
 *   &lt;small&gt;Note that currently for MCU enabled Peer connections, the &lt;code&gt;options.filterCandidatesType&lt;/code&gt;
 *   configuration is not honoured as Peers connected with MCU is similar as a forced TURN connection. The flags
 *   will act as if the value is &lt;code&gt;false&lt;/code&gt; and ICE candidates will never be filtered regardless of the
 *   &lt;code&gt;options.filterCandidatesType&lt;/code&gt; configuration.&lt;/small&gt;
 * @param {Boolean} [options.usePublicSTUN=true] The flag if publicly available STUN ICE servers should
 *   be used if &lt;code&gt;options.enableSTUNServer&lt;/code&gt; is enabled.
 * @param {Boolean} [options.TURNServerTransport] &lt;blockquote class=&quot;info&quot;&gt;
 *   Note that configuring the protocol may not necessarily result in the desired network transports protocol
 *   used in the actual TURN network traffic as it depends which protocol the browser selects and connects with.
 *   This simply configures the TURN ICE server urls &lt;code?transport=(protocol)&lt;/code&gt; query option when constructing
 *   the Peer connection. When all protocols are selected, the ICE servers urls are duplicated with all protocols.
 *   &lt;/blockquote&gt; The option to configure the &lt;code&gt;?transport=&lt;/code&gt;
 *   query parameter in TURN ICE servers when constructing a Peer connections.
 * - When not provided, its value is &lt;code&gt;ANY&lt;/code&gt;.
 *   [Rel: Skylink.TURN_TRANSPORT]
 * @param {Boolean} [options.disableVideoFecCodecs=false] &lt;blockquote class=&quot;info&quot;&gt;
 *   Note that this is an experimental flag and may cause disruptions in connections or connectivity issues when toggled,
 *   and to prevent connectivity issues, these codecs will not be removed for MCU enabled Peer connections.
 *   &lt;/blockquote&gt; The flag if video FEC (Forward Error Correction)
 *   codecs like ulpfec and red should be removed in sending session descriptions.
 *   &lt;small&gt;This can be useful for debugging purposes to prevent redundancy and overheads in RTP encoding.&lt;/small&gt;
 * @param {Boolean} [options.disableComfortNoiseCodec=false] &lt;blockquote class=&quot;info&quot;&gt;
 *   Note that this is an experimental flag and may cause disruptions in connections or connectivity issues when toggled.
 *   &lt;/blockquote&gt; The flag if audio
 *   &lt;a href=&quot;https://en.wikipedia.org/wiki/Comfort_noise&quot;&gt;Comfort Noise (CN)&lt;/a&gt; codec should be removed
 *   in sending session descriptions.
 *   &lt;small&gt;This can be useful for debugging purposes to test preferred audio quality and feedback.&lt;/small&gt;
 * @param {Boolean} [options.disableREMB=false] &lt;blockquote class=&quot;info&quot;&gt;
 *   Note that this is mainly used for debugging purposes and that it is an experimental flag, so
 *   it may cause disruptions in connections or connectivity issues when toggled. &lt;/blockquote&gt;
 *   The flag if video REMB feedback packets should be disabled in sending session descriptions.
 * @param {JSON} [options.credentials] The credentials used for authenticating App Key with
 *   credentials to retrieve the Room session token used for connection in &lt;a href=&quot;#method_joinRoom&quot;&gt;
 *   &lt;code&gt;joinRoom()&lt;/code&gt; method&lt;/a&gt;.
 *   &lt;small&gt;Note that switching of Rooms is not allowed when using credentials based authentication, unless
 *   &lt;code&gt;init()&lt;/code&gt; is invoked again with a different set of credentials followed by invoking
 *   the &lt;a href=&quot;#method_joinRoom&quot;&gt;&lt;code&gt;joinRoom()&lt;/code&gt; method&lt;/a&gt;.&lt;/small&gt;
 * @param {String} options.credentials.startDateTime The credentials User session in Room starting DateTime
 *   in &lt;a href=&quot;https://en.wikipedia.org/wiki/ISO_8601&quot;&gt;ISO 8601 format&lt;/a&gt;.
 * @param {Number} options.credentials.duration The credentials User session in Room duration in hours.
 * @param {String} options.credentials.credentials The generated credentials used to authenticate
 *   the provided App Key with its &lt;code&gt;&quot;secret&quot;&lt;/code&gt; property.
 *   &lt;blockquote class=&quot;details&quot;&gt;&lt;h5&gt;To generate the credentials:&lt;/h5&gt;&lt;ol&gt;
 *   &lt;li&gt;Concatenate a string that consists of the Room name you provide in the &lt;code&gt;options.defaultRoom&lt;/code&gt;,
 *   the &lt;code&gt;options.credentials.duration&lt;/code&gt; and the &lt;code&gt;options.credentials.startDateTime&lt;/code&gt;.
 *   &lt;small&gt;Example: &lt;code&gt;var concatStr = defaultRoom + &quot;_&quot; + duration + &quot;_&quot; + startDateTime;&lt;/code&gt;&lt;/small&gt;&lt;/li&gt;
 *   &lt;li&gt;Hash the concatenated string with the App Key &lt;code&gt;&quot;secret&quot;&lt;/code&gt; property using
 *   &lt;a href=&quot;https://en.wikipedia.org/wiki/SHA-1&quot;&gt;SHA-1&lt;/a&gt;.
 *   &lt;small&gt;Example: &lt;code&gt;var hash = CryptoJS.HmacSHA1(concatStr, appKeySecret);&lt;/code&gt;&lt;/small&gt;
 *   &lt;small&gt;See the &lt;a href=&quot;https://code.google.com/p/crypto-js/#HMAC&quot;&gt;&lt;code&gt;CryptoJS.HmacSHA1&lt;/code&gt; library&lt;/a&gt;.&lt;/small&gt;&lt;/li&gt;
 *   &lt;li&gt;Encode the hashed string using &lt;a href=&quot;https://en.wikipedia.org/wiki/Base64&quot;&gt;base64&lt;/a&gt;
 *   &lt;small&gt;Example: &lt;code&gt;var b64Str = hash.toString(CryptoJS.enc.Base64);&lt;/code&gt;&lt;/small&gt;
 *   &lt;small&gt;See the &lt;a href=&quot;https://code.google.com/p/crypto-js/#The_Cipher_Output&quot;&gt;CryptoJS.enc.Base64&lt;/a&gt; library&lt;/a&gt;.&lt;/small&gt;&lt;/li&gt;
 *   &lt;li&gt;Encode the base64 encoded string to replace special characters using UTF-8 encoding.
 *   &lt;small&gt;Example: &lt;code&gt;var credentials = encodeURIComponent(base64String);&lt;/code&gt;&lt;/small&gt;
 *   &lt;small&gt;See &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/
 * Global_Objects/encodeURIComponent&quot;&gt;encodeURIComponent() API&lt;/a&gt;.&lt;/small&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/blockquote&gt;
 * @param {Boolean} [options.audioFallback=false] The flag if &lt;a href=&quot;#method_getUserMedia&quot;&gt;
 *   &lt;code&gt;getUserMedia()&lt;/code&gt; method&lt;/a&gt; should fallback to retrieve only audio Stream when
 *   retrieving audio and video Stream fails.
 * @param {Boolean} [options.forceSSL=false] The flag if HTTPS connections should be enforced
 *   during request to Auth server and socket connections to Signaling server
 *   when accessing &lt;code&gt;window.location.protocol&lt;/code&gt; value is &lt;code&gt;&quot;http:&quot;&lt;/code&gt;.
 *   &lt;small&gt;By default, &lt;code&gt;&quot;https:&quot;&lt;/code&gt; protocol connections uses HTTPS connections.&lt;/small&gt;
 * @param {String} [options.audioCodec] &lt;blockquote class=&quot;info&quot;&gt;
 *   Note that if the audio codec is not supported, the SDK will not configure the local &lt;code&gt;&quot;offer&quot;&lt;/code&gt; or
 *   &lt;code&gt;&quot;answer&quot;&lt;/code&gt; session description to prefer the codec.&lt;/blockquote&gt;
 *   The option to configure the preferred audio codec
 *   to use to decode receiving audio data when available for Peer connection.
 * - When not provided, its value is &lt;code&gt;AUTO&lt;/code&gt;.
 *   &lt;small&gt;Note that Peers may override the receiving audio codec depending on the Peers configuration.&lt;/small&gt;
 *   [Rel: Skylink.AUDIO_CODEC]
 * @param {String} [options.videoCodec] &lt;blockquote class=&quot;info&quot;&gt;
 *   Note that if the video codec is not supported, the SDK will not configure the local &lt;code&gt;&quot;offer&quot;&lt;/code&gt; or
 *   &lt;code&gt;&quot;answer&quot;&lt;/code&gt; session description to prefer the codec.&lt;/blockquote&gt;
 *   The option to configure the preferred video codec
 *   to use to decode receiving video data when available for Peer connection.
 * - When not provided, its value is &lt;code&gt;AUTO&lt;/code&gt;.
 *   &lt;small&gt;Note that Peers may override the receiving video codec depending on the Peers configuration.&lt;/small&gt;
 *   [Rel: Skylink.VIDEO_CODEC]
 * @param {Number} [options.socketTimeout=20000] The timeout for each attempts for socket connection
 *   with the Signaling server to indicate that connection has timed out and has failed to establish.
 *   &lt;small&gt;Note that the mininum timeout value is &lt;code&gt;5000&lt;/code&gt;. If less, this value will be &lt;code&gt;5000&lt;/code&gt;.&lt;/small&gt;
 * @param {Boolean} [options.forceTURNSSL=false] &lt;blockquote class=&quot;info&quot;&gt;
 *   Note that currently Firefox does not support the TURNS protocol, and that if TURNS is required,
 *   TURN ICE servers using port &lt;code&gt;443&lt;/code&gt; will be used instead.&lt;/blockquote&gt;
 *   The flag if TURNS protocol should be used when &lt;code&gt;options.enableTURNServer&lt;/code&gt; is enabled.
 * @param {JSON} [options.filterCandidatesType] &lt;blockquote class=&quot;info&quot;&gt;
 *   Note that this a debugging feature and there might be connectivity issues when toggling these flags.
 *   &lt;/blockquote&gt; The configuration options to filter the type of ICE candidates sent and received.
 * @param {Boolean} [options.filterCandidatesType.host=false] The flag if local network ICE candidates should be filtered out.
 * @param {Boolean} [options.filterCandidatesType.srflx=false] The flag if STUN ICE candidates should be filtered out.
 * @param {Boolean} [options.filterCandidatesType.relay=false] The flag if TURN ICE candidates should be filtered out.
 * @param {JSON} [options.throttleIntervals] The configuration options to configure the throttling method timeouts.
 * @param {Number} [options.throttleIntervals.shareScreen=10000] The interval timeout for
 *   &lt;a href=&quot;#method_shareScreen&quot;&gt;&lt;code&gt;shareScreen()&lt;/code&gt; method&lt;/a&gt; throttling in milliseconds.
 * @param {Number} [options.throttleIntervals.getUserMedia=0] The interval timeout for
 *   &lt;a href=&quot;#method_getUserMedia&quot;&gt;&lt;code&gt;getUserMedia()&lt;/code&gt; method&lt;/a&gt; throttling in milliseconds.
 * @param {Number} [options.throttleIntervals.refreshConnection=5000] &lt;blockquote class=&quot;info&quot;&gt;
 *   Note that this throttling is only done for MCU enabled Peer connections with the
 *   &lt;code&gt;options.mcuUseRenegoRestart&lt;/code&gt; being set to &lt;code&gt;false&lt;/code&gt;.
 *   &lt;/blockquote&gt; The interval timeout for &lt;a href=&quot;#method_refreshConnection&quot;&gt;
 *   &lt;code&gt;refreshConnection()&lt;/code&gt; method&lt;/a&gt; throttling in milliseconds.
 *   &lt;small&gt;Note that there will be no throttling when &lt;a href=&quot;#method_refreshConnection&quot;&gt;
 *   &lt;code&gt;refreshConnection()&lt;/code&gt; method&lt;/a&gt; is called internally.&lt;/small&gt;
 * @param {Boolean} [options.throttleShouldThrowError=false] The flag if throttled methods should throw errors when
 *   method is invoked less than the interval timeout value configured in &lt;code&gt;options.throttleIntervals&lt;/code&gt;.
 * @param {Boolean} [options.mcuUseRenegoRestart=false] The flag if &lt;a href=&quot;#method_refreshConnection&quot;&gt;&lt;code&gt;
 *   refreshConnection()&lt;/code&gt; method&lt;/a&gt; should renegotiate like non-MCU enabled Peer connection for MCU
 *   enabled Peer connections instead of invoking &lt;a href=&quot;#method_joinRoom&quot;&gt;&lt;code&gt;joinRoom()&lt;/code&gt; method&lt;/a&gt; again.
 * @param {Function} [callback] The callback function fired when request has completed.
 *   &lt;small&gt;Function parameters signature is &lt;code&gt;function (error, success)&lt;/code&gt;&lt;/small&gt;
 *   &lt;small&gt;Function request completion is determined by the &lt;a href=&quot;#event_readyStateChange&quot;&gt;
 *   &lt;code&gt;readyStateChange&lt;/code&gt; event&lt;/a&gt; &lt;code&gt;state&lt;/code&gt; parameter payload value
 *   as &lt;code&gt;COMPLETED&lt;/code&gt; for request success.&lt;/small&gt;
 *   [Rel: Skylink.READY_STATE_CHANGE]
 * @param {JSON|String} callback.error The error result in request.
 * - When defined as string, it&#x27;s the error when required App Key is not provided.
 *   &lt;small&gt;Defined as &lt;code&gt;null&lt;/code&gt; when there are no errors in request&lt;/small&gt;
 * @param {Number} callback.error.errorCode The &lt;a href=&quot;#event_readyStateChange&quot;&gt;&lt;code&gt;readyStateChange&lt;/code&gt;
 *   event&lt;/a&gt; &lt;code&gt;error.errorCode&lt;/code&gt; parameter payload value.
 *   [Rel: Skylink.READY_STATE_CHANGE_ERROR]
 * @param {Object} callback.error.error The &lt;a href=&quot;#event_readyStateChange&quot;&gt;&lt;code&gt;readyStateChange&lt;/code&gt;
 *   event&lt;/a&gt; &lt;code&gt;error.content&lt;/code&gt; parameter payload value.
 * @param {Number} callback.error.status The &lt;a href=&quot;#event_readyStateChange&quot;&gt;&lt;code&gt;readyStateChange&lt;/code&gt;
 *   event&lt;/a&gt; &lt;code&gt;error.status&lt;/code&gt; parameter payload value.
 * @param {JSON} callback.success The success result in request.
 *   &lt;small&gt;Defined as &lt;code&gt;null&lt;/code&gt; when there are errors in request&lt;/small&gt;
 * @param {String} callback.success.serverUrl The constructed REST URL requested to Auth server.
 * @param {String} callback.success.readyState The current ready state.
 *   [Rel: Skylink.READY_STATE_CHANGE]
 * @param {String} callback.success.selectedRoom The Room based on the current Room session token retrieved for.
 * @param {String} callback.success.appKey The configured value of the &lt;code&gt;options.appKey&lt;/code&gt;.
 * @param {String} callback.success.defaultRoom The configured value of the &lt;code&gt;options.defaultRoom&lt;/code&gt;.
 * @param {String} callback.success.roomServer The configured value of the &lt;code&gt;options.roomServer&lt;/code&gt;.
 * @param {Boolean} callback.success.enableIceTrickle The configured value of the &lt;code&gt;options.enableIceTrickle&lt;/code&gt;.
 * @param {Boolean} callback.success.enableDataChannel The configured value of the &lt;code&gt;options.enableDataChannel&lt;/code&gt;.
 * @param {Boolean} callback.success.enableTURNServer The configured value of the &lt;code&gt;options.enableTURNServer&lt;/code&gt;.
 * @param {Boolean} callback.success.enableSTUNServer The configured value of the &lt;code&gt;options.enableSTUNServer&lt;/code&gt;.
 * @param {Boolean} callback.success.TURNTransport The configured value of the &lt;code&gt;options.TURNServerTransport&lt;/code&gt;.
 * @param {Boolean} callback.success.audioFallback The configured value of the &lt;code&gt;options.audioFallback&lt;/code&gt;.
 * @param {Boolean} callback.success.forceSSL The configured value of the &lt;code&gt;options.forceSSL&lt;/code&gt;.
 * @param {String} callback.success.audioCodec The configured value of the &lt;code&gt;options.audioCodec&lt;/code&gt;.
 * @param {String} callback.success.videoCodec The configured value of the &lt;code&gt;options.videoCodec&lt;/code&gt;.
 * @param {Number} callback.success.socketTimeout The configured value of the &lt;code&gt;options.socketTimeout&lt;/code&gt;.
 * @param {Boolean} callback.success.forceTURNSSL The configured value of the &lt;code&gt;options.forceTURNSSL&lt;/code&gt;.
 * @param {Boolean} callback.success.forceTURN The configured value of the &lt;code&gt;options.forceTURN&lt;/code&gt;.
 * @param {Boolean} callback.success.usePublicSTUN The configured value of the &lt;code&gt;options.usePublicSTUN&lt;/code&gt;.
 * @param {Boolean} callback.success.disableVideoFecCodecs The configured value of the &lt;code&gt;options.disableVideoFecCodecs&lt;/code&gt;.
 * @param {Boolean} callback.success.disableComfortNoiseCodec The configured value of the &lt;code&gt;options.disableComfortNoiseCodec&lt;/code&gt;.
 * @param {Boolean} callback.success.disableREMB The configured value of the &lt;code&gt;options.disableREMB&lt;/code&gt;.
 * @param {JSON} callback.success.filterCandidatesType The configured value of the &lt;code&gt;options.filterCandidatesType&lt;/code&gt;.
 * @param {Number} callback.success.throttleIntervals The configured value of the &lt;code&gt;options.throttleIntervals&lt;/code&gt;.
 * @param {Number} callback.success.throttleShouldThrowError The configured value of the &lt;code&gt;options.throttleShouldThrowError&lt;/code&gt;.
 * @param {Number} callback.success.mcuUseRenegoRestart The configured value of the &lt;code&gt;options.mcuUseRenegoRestart&lt;/code&gt;.
 * @example
 *   // Example 1: Using CORS authentication and connection to default Room
 *   skylinkDemo(appKey, function (error, success) {
 *     if (error) return;
 *     skylinkDemo.joinRoom(); // Goes to default Room
 *   });
 *
 *   // Example 2: Using CORS authentication and connection to a different Room
 *   skylinkDemo(appKey, function (error, success) {
 *     skylinkDemo.joinRoom(&quot;testxx&quot;); // Goes to &quot;testxx&quot; Room
 *   });
 *
 *   // Example 3: Using credentials authentication and connection to only default Room
 *   var defaultRoom   = &quot;test&quot;,
 *       startDateTime = (new Date()).toISOString(),
 *       duration      = 1, // Allows only User session to stay for 1 hour
 *       appKeySecret  = &quot;xxxxxxx&quot;,
 *       hash          = CryptoJS.HmacSHA1(defaultRoom + &quot;_&quot; + duration + &quot;_&quot; + startDateTime, appKeySecret);
 *       credentials   = encodeURIComponent(hash.toString(CryptoJS.enc.Base64));
 *
 *   skylinkDemo({
 *     defaultRoom: defaultRoom,
 *     appKey: appKey,
 *     credentials: {
 *       duration: duration,
 *       startDateTime: startDateTime,
 *       credentials: credentials
 *     }
 *   }, function (error, success) {
 *     if (error) return;
 *     skylinkDemo.joinRoom(); // Goes to default Room (switching to different Room is not allowed for credentials authentication)
 *   });
 * @trigger &lt;ol class=&quot;desc-seq&quot;&gt;
 *   &lt;li&gt;If parameter &lt;code&gt;options&lt;/code&gt; is not provided: &lt;ol&gt;&lt;li&gt;&lt;b&gt;ABORT&lt;/b&gt; and return error.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;
 *   &lt;li&gt;Checks if dependecies and browser APIs are available. &lt;ol&gt;&lt;li&gt;If AdapterJS is not loaded: &lt;ol&gt;
 *   &lt;li&gt;&lt;a href=&quot;#event_readyStateChange&quot;&gt;&lt;code&gt;readyStateChange&lt;/code&gt; event&lt;/a&gt; triggers
 *   parameter payload &lt;code&gt;state&lt;/code&gt; as &lt;code&gt;ERROR&lt;/code&gt; and &lt;code&gt;error.errorCode&lt;/code&gt; as
 *   &lt;code&gt;ADAPTER_NO_LOADED&lt;/code&gt;.&lt;/li&gt;&lt;li&gt;&lt;b&gt;ABORT&lt;/b&gt; and return error.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;
 *   &lt;li&gt;If socket.io-client is not loaded: &lt;ol&gt;&lt;li&gt;&lt;a href=&quot;#event_readyStateChange&quot;&gt;
 *   &lt;code&gt;readyStateChange&lt;/code&gt; event&lt;/a&gt; triggers parameter payload &lt;code&gt;state&lt;/code&gt;
 *   as &lt;code&gt;ERROR&lt;/code&gt; and &lt;code&gt;error.errorCode&lt;/code&gt; as &lt;code&gt;NO_SOCKET_IO&lt;/code&gt;.&lt;/li&gt;
 *   &lt;li&gt;&lt;b&gt;ABORT&lt;/b&gt; and return error. &lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;
 *   &lt;li&gt;If XMLHttpRequest API is not available: &lt;ol&gt;&lt;li&gt;&lt;a href=&quot;#event_readyStateChange&quot;&gt;
 *   &lt;code&gt;readyStateChange&lt;/code&gt; event&lt;/a&gt; triggers parameter payload &lt;code&gt;state&lt;/code&gt;
 *   as &lt;code&gt;ERROR&lt;/code&gt; and &lt;code&gt;error.errorCode&lt;/code&gt; as &lt;code&gt;NO_XMLHTTPREQUEST_SUPPORT&lt;/code&gt;.&lt;/li&gt;
 *   &lt;li&gt;&lt;b&gt;ABORT&lt;/b&gt; and return error.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;If WebRTC is not supported by device: &lt;ol&gt;
 *   &lt;li&gt;&lt;a href=&quot;#event_readyStateChange&quot;&gt;&lt;code&gt;readyStateChange&lt;/code&gt; event&lt;/a&gt; triggers parameter
 *   payload &lt;code&gt;state&lt;/code&gt; as &lt;code&gt;ERROR&lt;/code&gt; and &lt;code&gt;error.errorCode&lt;/code&gt; as
 *   &lt;code&gt;NO_WEBRTC_SUPPORT&lt;/code&gt;.&lt;/li&gt;&lt;li&gt;&lt;b&gt;ABORT&lt;/b&gt; and return error.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;
 *   &lt;li&gt;Retrieves Room session token from Auth server. &lt;ol&gt;
 *   &lt;li&gt;&lt;a href=&quot;#event_readyStateChange&quot;&gt;&lt;code&gt;readyStateChange&lt;/code&gt; event&lt;/a&gt; triggers
 *   parameter payload &lt;code&gt;state&lt;/code&gt; as &lt;code&gt;LOADING&lt;/code&gt;.&lt;/li&gt;
 *   &lt;li&gt;If retrieval was successful: &lt;ol&gt;&lt;li&gt;&lt;a href=&quot;#event_readyStateChange&quot;&gt;&lt;code&gt;readyStateChange&lt;/code&gt; event&lt;/a&gt;
 *   triggers parameter payload &lt;code&gt;state&lt;/code&gt; as &lt;code&gt;COMPLETED&lt;/code&gt;.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Else: &lt;ol&gt;
 *   &lt;li&gt;&lt;a href=&quot;#event_readyStateChange&quot;&gt;&lt;code&gt;readyStateChange&lt;/code&gt; event&lt;/a&gt; triggers parameter
 *   payload &lt;code&gt;state&lt;/code&gt; as &lt;code&gt;ERROR&lt;/code&gt;.&lt;/li&gt;&lt;li&gt;&lt;b&gt;ABORT&lt;/b&gt; and return error.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;
 * @for Skylink
 * @since 0.5.5
 */
Skylink.prototype.init = function(options, callback) {
  var self = this;

  if (typeof options === &#x27;function&#x27;){
    callback = options;
    options = undefined;
  }

  if (!options) {
    var error = &#x27;No API key provided&#x27;;
    log.error(error);
    if (typeof callback === &#x27;function&#x27;){
      callback(error,null);
    }
    return;
  }

  var appKey, room, defaultRoom;
  var startDateTime, duration, credentials;
  var roomServer = self._roomServer;
  // NOTE: Should we get all the default values from the variables
  // rather than setting it?
  var enableIceTrickle = true;
  var enableDataChannel = true;
  var enableSTUNServer = true;
  var enableTURNServer = true;
  var TURNTransport = self.TURN_TRANSPORT.ANY;
  var audioFallback = false;
  var forceSSL = false;
  var socketTimeout = 20000;
  var forceTURNSSL = false;
  var audioCodec = self.AUDIO_CODEC.AUTO;
  var videoCodec = self.VIDEO_CODEC.AUTO;
  var forceTURN = false;
  var usePublicSTUN = true;
  var disableVideoFecCodecs = false;
  var disableComfortNoiseCodec = false;
  var disableREMB = false;
  var filterCandidatesType = {
    host: false,
    srflx: false,
    relay: false
  };
  var throttleIntervals = {
    shareScreen: 10000,
    refreshConnection: 5000,
    getUserMedia: 0
  };
  var throttleShouldThrowError = false;
  var mcuUseRenegoRestart = false;

  log.log(&#x27;Provided init options:&#x27;, options);

  if (typeof options === &#x27;string&#x27;) {
    // set all the default api key, default room and room
    appKey = options;
    defaultRoom = appKey;
    room = appKey;
  } else {
    // set the api key
    appKey = options.appKey || options.apiKey;
    // set the room server
    roomServer = (typeof options.roomServer === &#x27;string&#x27;) ?
      options.roomServer : roomServer;
    // check room server if it ends with /. Remove the extra /
    roomServer = (roomServer.lastIndexOf(&#x27;/&#x27;) ===
      (roomServer.length - 1)) ? roomServer.substring(0,
      roomServer.length - 1) : roomServer;
    // set the default room
    defaultRoom = (typeof options.defaultRoom === &#x27;string&#x27; &amp;&amp; options.defaultRoom) ?
      options.defaultRoom : appKey;
    // set the selected room
    room = defaultRoom;
    // set ice trickle option
    enableIceTrickle = (typeof options.enableIceTrickle === &#x27;boolean&#x27;) ?
      options.enableIceTrickle : enableIceTrickle;
    // set data channel option
    enableDataChannel = (typeof options.enableDataChannel === &#x27;boolean&#x27;) ?
      options.enableDataChannel : enableDataChannel;
    // set stun server option
    enableSTUNServer = (typeof options.enableSTUNServer === &#x27;boolean&#x27;) ?
      options.enableSTUNServer : enableSTUNServer;
    // set turn server option
    enableTURNServer = (typeof options.enableTURNServer === &#x27;boolean&#x27;) ?
      options.enableTURNServer : enableTURNServer;
    // set the force ssl always option
    forceSSL = (typeof options.forceSSL === &#x27;boolean&#x27;) ?
      options.forceSSL : forceSSL;
    // set the socket timeout option
    socketTimeout = (typeof options.socketTimeout === &#x27;number&#x27;) ?
      options.socketTimeout : socketTimeout;
    // set the socket timeout option to be above 5000
    socketTimeout = (socketTimeout &lt; 5000) ? 5000 : socketTimeout;
    // set the force turn ssl always option
    forceTURNSSL = (typeof options.forceTURNSSL === &#x27;boolean&#x27;) ?
      options.forceTURNSSL : forceTURNSSL;
    // set the preferred audio codec
    audioCodec = typeof options.audioCodec === &#x27;string&#x27; ?
      options.audioCodec : audioCodec;
    // set the preferred video codec
    videoCodec = typeof options.videoCodec === &#x27;string&#x27; ?
      options.videoCodec : videoCodec;
    // set the force turn server option
    forceTURN = (typeof options.forceTURN === &#x27;boolean&#x27;) ?
      options.forceTURN : forceTURN;
    // set the use public stun option
    usePublicSTUN = (typeof options.usePublicSTUN === &#x27;boolean&#x27;) ?
      options.usePublicSTUN : usePublicSTUN;
    // set the use of disabling ulpfec and red codecs
    disableVideoFecCodecs = (typeof options.disableVideoFecCodecs === &#x27;boolean&#x27;) ?
      options.disableVideoFecCodecs : disableVideoFecCodecs;
    // set the use of disabling CN codecs
    disableComfortNoiseCodec = (typeof options.disableComfortNoiseCodec === &#x27;boolean&#x27;) ?
      options.disableComfortNoiseCodec : disableComfortNoiseCodec;
    // set the use of disabling REMB packets
    disableREMB = (typeof options.disableREMB === &#x27;boolean&#x27;) ?
      options.disableREMB : disableREMB;
    // set the flag if throttling should throw error when called less than the interval timeout configured
    throttleShouldThrowError = (typeof options.throttleShouldThrowError === &#x27;boolean&#x27;) ?
      options.throttleShouldThrowError : throttleShouldThrowError;
    // set the flag if MCU refreshConnection() should use renegotiation
    mcuUseRenegoRestart = (typeof options.mcuUseRenegoRestart === &#x27;boolean&#x27;) ?
      options.mcuUseRenegoRestart : mcuUseRenegoRestart;
    // set the use of filtering ICE candidates
    if (typeof options.filterCandidatesType === &#x27;object&#x27; &amp;&amp; options.filterCandidatesType) {
      filterCandidatesType.host = (typeof options.filterCandidatesType.host === &#x27;boolean&#x27;) ?
        options.filterCandidatesType.host : filterCandidatesType.host;
      filterCandidatesType.srflx = (typeof options.filterCandidatesType.srflx === &#x27;boolean&#x27;) ?
        options.filterCandidatesType.srflx : filterCandidatesType.srflx;
      filterCandidatesType.relay = (typeof options.filterCandidatesType.relay === &#x27;boolean&#x27;) ?
        options.filterCandidatesType.relay : filterCandidatesType.relay;
    }
    // set the use of throttling interval timeouts
    if (typeof options.throttleIntervals === &#x27;object&#x27; &amp;&amp; options.throttleIntervals) {
      throttleIntervals.shareScreen = (typeof options.throttleIntervals.shareScreen === &#x27;number&#x27;) ?
        options.throttleIntervals.shareScreen : throttleIntervals.shareScreen;
      throttleIntervals.refreshConnection = (typeof options.throttleIntervals.refreshConnection === &#x27;number&#x27;) ?
        options.throttleIntervals.refreshConnection : throttleIntervals.refreshConnection;
      throttleIntervals.getUserMedia = (typeof options.throttleIntervals.getUserMedia === &#x27;number&#x27;) ?
        options.throttleIntervals.getUserMedia : throttleIntervals.getUserMedia;
    }

    // set turn transport option
    if (typeof options.TURNServerTransport === &#x27;string&#x27;) {
      // loop out for every transport option
      for (var type in self.TURN_TRANSPORT) {
        if (self.TURN_TRANSPORT.hasOwnProperty(type)) {
          // do a check if the transport option is valid
          if (self.TURN_TRANSPORT[type] === options.TURNServerTransport) {
            TURNTransport = options.TURNServerTransport;
            break;
          }
        }
      }
    }
    // set audio fallback option
    audioFallback = options.audioFallback || audioFallback;
    // Custom default meeting timing and duration
    // Fallback to default if no duration or startDateTime provided
    if (options.credentials &amp;&amp;
      typeof options.credentials.credentials === &#x27;string&#x27; &amp;&amp;
      typeof options.credentials.duration === &#x27;number&#x27; &amp;&amp;
      typeof options.credentials.startDateTime === &#x27;string&#x27;) {
      // set start data time
      startDateTime = options.credentials.startDateTime;
      // set the duration
      duration = options.credentials.duration;
      // set the credentials
      credentials = options.credentials.credentials;
    }

    // if force turn option is set to on
    if (forceTURN === true) {
      enableTURNServer = true;
      enableSTUNServer = false;
      filterCandidatesType.host = true;
      filterCandidatesType.srflx = true;
      filterCandidatesType.relay = false;
    }
  }
  // api key path options
  self._appKey = appKey;
  self._roomServer = roomServer;
  self._defaultRoom = defaultRoom;
  self._selectedRoom = room;
  self._path = roomServer + &#x27;/api/&#x27; + appKey + &#x27;/&#x27; + room;
  // set credentials if there is
  if (credentials &amp;&amp; startDateTime &amp;&amp; duration) {
    self._roomStart = startDateTime;
    self._roomDuration = duration;
    self._roomCredentials = credentials;
    self._path += (credentials) ? (&#x27;/&#x27; + startDateTime + &#x27;/&#x27; +
      duration + &#x27;?&amp;cred=&#x27; + credentials) : &#x27;&#x27;;
  }

  self._path += ((credentials) ? &#x27;&amp;&#x27; : &#x27;?&#x27;) + &#x27;rand=&#x27; + (new Date()).toISOString();

  // skylink functionality options
  self._enableIceTrickle = enableIceTrickle;
  self._enableDataChannel = enableDataChannel;
  self._enableSTUN = enableSTUNServer;
  self._enableTURN = enableTURNServer;
  self._TURNTransport = TURNTransport;
  self._audioFallback = audioFallback;
  self._forceSSL = forceSSL;
  self._socketTimeout = socketTimeout;
  self._forceTURNSSL = forceTURNSSL;
  self._selectedAudioCodec = audioCodec;
  self._selectedVideoCodec = videoCodec;
  self._forceTURN = forceTURN;
  self._usePublicSTUN = usePublicSTUN;
  self._disableVideoFecCodecs = disableVideoFecCodecs;
  self._disableComfortNoiseCodec = disableComfortNoiseCodec;
  self._filterCandidatesType = filterCandidatesType;
  self._throttlingTimeouts = throttleIntervals;
  self._throttlingShouldThrowError = throttleShouldThrowError;
  self._disableREMB = disableREMB;
  self._mcuUseRenegoRestart = mcuUseRenegoRestart;

  log.log(&#x27;Init configuration:&#x27;, {
    serverUrl: self._path,
    readyState: self._readyState,
    appKey: self._appKey,
    roomServer: self._roomServer,
    defaultRoom: self._defaultRoom,
    selectedRoom: self._selectedRoom,
    enableDataChannel: self._enableDataChannel,
    enableIceTrickle: self._enableIceTrickle,
    enableTURNServer: self._enableTURN,
    enableSTUNServer: self._enableSTUN,
    TURNTransport: self._TURNTransport,
    audioFallback: self._audioFallback,
    forceSSL: self._forceSSL,
    socketTimeout: self._socketTimeout,
    forceTURNSSL: self._forceTURNSSL,
    audioCodec: self._selectedAudioCodec,
    videoCodec: self._selectedVideoCodec,
    forceTURN: self._forceTURN,
    usePublicSTUN: self._usePublicSTUN,
    disableVideoFecCodecs: self._disableVideoFecCodecs,
    disableComfortNoiseCodec: self._disableComfortNoiseCodec,
    disableREMB: self._disableREMB,
    filterCandidatesType: self._filterCandidatesType,
    throttleIntervals: self._throttlingTimeouts,
    throttleShouldThrowError: self._throttlingShouldThrowError,
    mcuUseRenegoRestart: self._mcuUseRenegoRestart
  });
  // trigger the readystate
  self._readyState = 0;
  self._trigger(&#x27;readyStateChange&#x27;, self.READY_STATE_CHANGE.INIT, null, self._selectedRoom);

  if (typeof callback === &#x27;function&#x27;){
    var hasTriggered = false;

    var readyStateChangeFn = function (readyState, error) {
      if (!hasTriggered) {
        if (readyState === self.READY_STATE_CHANGE.COMPLETED) {
          log.log([null, &#x27;Socket&#x27;, null, &#x27;Firing callback. &#x27; +
          &#x27;Ready state change has met provided state -&gt;&#x27;], readyState);
          hasTriggered = true;
          self.off(&#x27;readyStateChange&#x27;, readyStateChangeFn);
          callback(null,{
            serverUrl: self._path,
            readyState: self._readyState,
            appKey: self._appKey,
            roomServer: self._roomServer,
            defaultRoom: self._defaultRoom,
            selectedRoom: self._selectedRoom,
            enableDataChannel: self._enableDataChannel,
            enableIceTrickle: self._enableIceTrickle,
            enableTURNServer: self._enableTURN,
            enableSTUNServer: self._enableSTUN,
            TURNTransport: self._TURNTransport,
            audioFallback: self._audioFallback,
            forceSSL: self._forceSSL,
            socketTimeout: self._socketTimeout,
            forceTURNSSL: self._forceTURNSSL,
            audioCodec: self._selectedAudioCodec,
            videoCodec: self._selectedVideoCodec,
            forceTURN: self._forceTURN,
            usePublicSTUN: self._usePublicSTUN,
            disableVideoFecCodecs: self._disableVideoFecCodecs,
            disableComfortNoiseCodec: self._disableComfortNoiseCodec,
            disableREMB: self._disableREMB,
            filterCandidatesType: self._filterCandidatesType,
            throttleIntervals: self._throttlingTimeouts,
            throttleShouldThrowError: self._throttlingShouldThrowError,
            mcuUseRenegoRestart: self._mcuUseRenegoRestart
          });
        } else if (readyState === self.READY_STATE_CHANGE.ERROR) {
          log.log([null, &#x27;Socket&#x27;, null, &#x27;Firing callback. &#x27; +
            &#x27;Ready state change has met provided state -&gt;&#x27;], readyState);
          log.debug([null, &#x27;Socket&#x27;, null, &#x27;Ready state met failure&#x27;], error);
          hasTriggered = true;
          self.off(&#x27;readyStateChange&#x27;, readyStateChangeFn);
          callback({
            error: new Error(error),
            errorCode: error.errorCode,
            status: error.status
          },null);
        }
      }
    };

    self.on(&#x27;readyStateChange&#x27;, readyStateChangeFn);
  }

  self._loadInfo();
};

/**
 * Starts retrieving Room credentials information from API server.
 * @method _requestServerInfo
 * @private
 * @for Skylink
 * @since 0.5.2
 */
Skylink.prototype._requestServerInfo = function(method, url, callback, params) {
  var self = this;
  // XDomainRequest is supported in IE8 - 9
  var useXDomainRequest = typeof window.XDomainRequest === &#x27;function&#x27; ||
    typeof window.XDomainRequest === &#x27;object&#x27;;

  self._socketUseXDR = useXDomainRequest;
  var xhr;

  // set force SSL option
  url = (self._forceSSL) ? &#x27;https:&#x27; + url : url;

  if (useXDomainRequest) {
    log.debug([null, &#x27;XMLHttpRequest&#x27;, method, &#x27;Using XDomainRequest. &#x27; +
      &#x27;XMLHttpRequest is now XDomainRequest&#x27;], {
      agent: window.webrtcDetectedBrowser,
      version: window.webrtcDetectedVersion
    });
    xhr = new XDomainRequest();
    xhr.setContentType = function (contentType) {
      xhr.contentType = contentType;
    };
  } else {
    log.debug([null, &#x27;XMLHttpRequest&#x27;, method, &#x27;Using XMLHttpRequest&#x27;], {
      agent: window.webrtcDetectedBrowser,
      version: window.webrtcDetectedVersion
    });
    xhr = new window.XMLHttpRequest();
    xhr.setContentType = function (contentType) {
      xhr.setRequestHeader(&#x27;Content-type&#x27;, contentType);
    };
  }

  xhr.onload = function () {
    var response = xhr.responseText || xhr.response;
    var status = xhr.status || 200;
    log.debug([null, &#x27;XMLHttpRequest&#x27;, method, &#x27;Received sessions parameters&#x27;],
      JSON.parse(response || &#x27;{}&#x27;));
    callback(status, JSON.parse(response || &#x27;{}&#x27;));
  };

  xhr.onerror = function (error) {
    log.error([null, &#x27;XMLHttpRequest&#x27;, method, &#x27;Failed retrieving information:&#x27;],
      { status: xhr.status });
    self._readyState = -1;
    self._trigger(&#x27;readyStateChange&#x27;, self.READY_STATE_CHANGE.ERROR, {
      status: xhr.status || null,
      content: &#x27;Network error occurred. (Status: &#x27; + xhr.status + &#x27;)&#x27;,
      errorCode: self.READY_STATE_CHANGE_ERROR.XML_HTTP_REQUEST_ERROR
    }, self._selectedRoom);
  };

  xhr.onprogress = function () {
    log.debug([null, &#x27;XMLHttpRequest&#x27;, method,
      &#x27;Retrieving information and config from webserver. Url:&#x27;], url);
    log.debug([null, &#x27;XMLHttpRequest&#x27;, method, &#x27;Provided parameters:&#x27;], params);
  };

  xhr.open(method, url, true);
  if (params) {
    xhr.setContentType(&#x27;application/json;charset=UTF-8&#x27;);
    xhr.send(JSON.stringify(params));
  } else {
    xhr.send();
  }
};

/**
 * Parses the Room credentials information retrieved from API server.
 * @method _parseInfo
 * @private
 * @for Skylink
 * @since 0.5.2
 */
Skylink.prototype._parseInfo = function(info) {
  log.log(&#x27;Parsing parameter from server&#x27;, info);
  if (!info.pc_constraints &amp;&amp; !info.offer_constraints) {
    this._trigger(&#x27;readyStateChange&#x27;, this.READY_STATE_CHANGE.ERROR, {
      status: 200,
      content: info.info,
      errorCode: info.error
    }, self._selectedRoom);
    return;
  }

  log.debug(&#x27;Peer connection constraints:&#x27;, info.pc_constraints);
  log.debug(&#x27;Offer constraints:&#x27;, info.offer_constraints);

  this._key = info.cid;
  this._appKeyOwner = info.apiOwner;

  this._signalingServer = info.ipSigserver;
  this._signalingServerPort = null;

  this._isPrivileged = info.isPrivileged;
  this._autoIntroduce = info.autoIntroduce;

  this._user = {
    uid: info.username,
    token: info.userCred,
    timeStamp: info.timeStamp,
    streams: [],
    info: {}
  };
  this._room = {
    id: info.room_key,
    token: info.roomCred,
    startDateTime: info.start,
    duration: info.len,
    connection: {
      peerConstraints: JSON.parse(info.pc_constraints),
      peerConfig: null,
      offerConstraints: JSON.parse(info.offer_constraints),
      sdpConstraints: {
        mandatory: {
          OfferToReceiveAudio: true,
          OfferToReceiveVideo: true
        }
      },
      mediaConstraints: JSON.parse(info.media_constraints)
    }
  };
  //this._parseDefaultMediaStreamSettings(this._room.connection.mediaConstraints);

  // set the socket ports
  this._socketPorts = {
    &#x27;http:&#x27;: info.httpPortList,
    &#x27;https:&#x27;: info.httpsPortList
  };

  // use default bandwidth and media resolution provided by server
  //this._streamSettings.bandwidth = info.bandwidth;
  //this._streamSettings.video = info.video;
  this._readyState = 2;
  this._trigger(&#x27;readyStateChange&#x27;, this.READY_STATE_CHANGE.COMPLETED, null, this._selectedRoom);
  log.info(&#x27;Parsed parameters from webserver. &#x27; +
    &#x27;Ready for web-realtime communication&#x27;);

};

/**
 * Loads and checks the dependencies if they are loaded correctly.
 * @method _loadInfo
 * @private
 * @for Skylink
 * @since 0.5.2
 */
Skylink.prototype._loadInfo = function() {
  var self = this;

  // check if adapterjs has been loaded already first or not
  var adapter = (function () {
    try {
      return window.AdapterJS || AdapterJS;
    } catch (error) {
      return false;
    }
  })();

  if (!(!!adapter ? typeof adapter.webRTCReady === &#x27;function&#x27; : false)) {
    var noAdapterErrorMsg = &#x27;AdapterJS dependency is not loaded or incorrect AdapterJS dependency is used&#x27;;
    self._trigger(&#x27;readyStateChange&#x27;, self.READY_STATE_CHANGE.ERROR, {
      status: null,
      content: noAdapterErrorMsg,
      errorCode: self.READY_STATE_CHANGE_ERROR.ADAPTER_NO_LOADED
    }, self._selectedRoom);
    return;
  }
  if (!window.io) {
    log.error(&#x27;Socket.io not loaded. Please load socket.io&#x27;);
    self._readyState = -1;
    self._trigger(&#x27;readyStateChange&#x27;, self.READY_STATE_CHANGE.ERROR, {
      status: null,
      content: &#x27;Socket.io not found&#x27;,
      errorCode: self.READY_STATE_CHANGE_ERROR.NO_SOCKET_IO
    }, self._selectedRoom);
    return;
  }
  if (!window.XMLHttpRequest) {
    log.error(&#x27;XMLHttpRequest not supported. Please upgrade your browser&#x27;);
    self._readyState = -1;
    self._trigger(&#x27;readyStateChange&#x27;, self.READY_STATE_CHANGE.ERROR, {
      status: null,
      content: &#x27;XMLHttpRequest not available&#x27;,
      errorCode: self.READY_STATE_CHANGE_ERROR.NO_XMLHTTPREQUEST_SUPPORT
    }, self._selectedRoom);
    return;
  }
  if (!self._path) {
    log.error(&#x27;Skylink is not initialised. Please call init() first&#x27;);
    self._readyState = -1;
    self._trigger(&#x27;readyStateChange&#x27;, self.READY_STATE_CHANGE.ERROR, {
      status: null,
      content: &#x27;No API Path is found&#x27;,
      errorCode: self.READY_STATE_CHANGE_ERROR.NO_PATH
    }, self._selectedRoom);
    return;
  }
  adapter.webRTCReady(function () {
    self._isUsingPlugin = !!adapter.WebRTCPlugin.plugin &amp;&amp; !!adapter.WebRTCPlugin.plugin.VERSION;

    if (!window.RTCPeerConnection) {
      log.error(&#x27;WebRTC not supported. Please upgrade your browser&#x27;);
      self._readyState = -1;
      self._trigger(&#x27;readyStateChange&#x27;, self.READY_STATE_CHANGE.ERROR, {
        status: null,
        content: &#x27;WebRTC not available&#x27;,
        errorCode: self.READY_STATE_CHANGE_ERROR.NO_WEBRTC_SUPPORT
      }, self._selectedRoom);
      return;
    }
    self._readyState = 1;
    self._trigger(&#x27;readyStateChange&#x27;, self.READY_STATE_CHANGE.LOADING, null, self._selectedRoom);
    self._requestServerInfo(&#x27;GET&#x27;, self._path, function(status, response) {
      if (status !== 200) {
        // 403 - Room is locked
        // 401 - API Not authorized
        // 402 - run out of credits
        var errorMessage = &#x27;XMLHttpRequest status not OK\nStatus was: &#x27; + status;
        self._readyState = 0;
        self._trigger(&#x27;readyStateChange&#x27;, self.READY_STATE_CHANGE.ERROR, {
          status: status,
          content: (response) ? (response.info || errorMessage) : errorMessage,
          errorCode: response.error ||
            self.READY_STATE_CHANGE_ERROR.INVALID_XMLHTTPREQUEST_STATUS
        }, self._selectedRoom);
        return;
      }
      self._parseInfo(response);
    });
  });
};

/**
 * Starts initialising for Room credentials for room name provided in &lt;code&gt;joinRoom()&lt;/code&gt; method.
 * @method _initSelectedRoom
 * @private
 * @for Skylink
 * @since 0.5.5
 */
Skylink.prototype._initSelectedRoom = function(room, callback) {
  var self = this;
  if (typeof room === &#x27;function&#x27; || typeof room === &#x27;undefined&#x27;) {
    log.error(&#x27;Invalid room provided. Room:&#x27;, room);
    return;
  }
  var defaultRoom = self._defaultRoom;
  var initOptions = {
    appKey: self._appKey,
    roomServer: self._roomServer,
    defaultRoom: room,
    enableDataChannel: self._enableDataChannel,
    enableIceTrickle: self._enableIceTrickle,
    enableTURNServer: self._enableTURN,
    enableSTUNServer: self._enableSTUN,
    TURNServerTransport: self._TURNTransport,
    audioFallback: self._audioFallback,
    forceSSL: self._forceSSL,
    socketTimeout: self._socketTimeout,
    forceTURNSSL: self._forceTURNSSL,
    audioCodec: self._selectedAudioCodec,
    videoCodec: self._selectedVideoCodec,
    forceTURN: self._forceTURN,
    usePublicSTUN: self._usePublicSTUN,
    disableVideoFecCodecs: self._disableVideoFecCodecs,
    disableComfortNoiseCodec: self._disableComfortNoiseCodec,
    disableREMB: self._disableREMB,
    filterCandidatesType: self._filterCandidatesType,
    throttleIntervals: self._throttlingTimeouts,
    throttleShouldThrowError: self._throttlingShouldThrowError,
    mcuUseRenegoRestart: self._mcuUseRenegoRestart
  };
  if (self._roomCredentials) {
    initOptions.credentials = {
      credentials: self._roomCredentials,
      duration: self._roomDuration,
      startDateTime: self._roomStart
    };
  }
  self.init(initOptions, function (error, success) {
    self._defaultRoom = defaultRoom;
    if (error) {
      callback(error, null);
    } else {
      callback(null, success);
    }
  });
};


    </pre>
</div>

                  </div>
              </div>
          </div>
      </div>
  </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
